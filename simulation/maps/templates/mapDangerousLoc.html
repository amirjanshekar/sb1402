<html>

<head>

    <title>Quick Start - Leaflet</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico">


    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
        crossorigin="">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>



    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
        integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
        crossorigin=""></script>
    {% load static %}
    <script
        src={% static '/js/lib/leaflet-ant-path-bower-master/leaflet-ant-path-bower-master/dist/leaflet-ant-path.js' %}></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>

<body data-gr-c-s-loaded="true">
    <div class="d-flex w-100 vh-100">
        <div class="d-flex container flex-column justify-content-center h-100 align-items-center">
            <h5 class="mb-4">Please choose locations on map or fill them in input fields with separation with "," or choose Excel file with "Browse..." button</h5>
        <div class="w-100 d-flex align-items-center justify-content-center flex-row card h-75 py-2 shadow">
            <div class="d-flex flex-column align-items-center justify-content-center py-2" style="width: 60%">
                <div id="mapid" class="d-flex position-relative justify-content-center card shadow-sm
                    leaflet-container leaflet-retina leaflet-fade-anim leaflet-grab leaflet-touch-drag d-flex" tabindex="0" style="height: 40vh; width: 80%">
                    <div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);">
                        <div class="leaflet-pane leaflet-tile-pane">
                            <div class="leaflet-layer " style="z-index: 1; opacity: 1;">
                                <div class="leaflet-tile-container leaflet-zoom-animated"
                                    style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt=""
                                        role="presentation"
                                        src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2046/1361?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                                        class="leaflet-tile leaflet-tile-loaded"
                                        style="width: 512px; height: 512px; transform: translate3d(-200px, -347px, 0px); opacity: 1;"><img
                                        alt="" role="presentation"
                                        src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2047/1361?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                                        class="leaflet-tile leaflet-tile-loaded"
                                        style="width: 512px; height: 512px; transform: translate3d(312px, -347px, 0px); opacity: 1;"><img
                                        alt="" role="presentation"
                                        src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2046/1362?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                                        class="leaflet-tile leaflet-tile-loaded"
                                        style="width: 512px; height: 512px; transform: translate3d(-200px, 165px, 0px); opacity: 1;"><img
                                        alt="" role="presentation"
                                        src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2047/1362?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                                        class="leaflet-tile leaflet-tile-loaded"
                                        style="width: 512px; height: 512px; transform: translate3d(312px, 165px, 0px); opacity: 1;">
                                </div>
                            </div>
                        </div>
                        <div class="leaflet-pane leaflet-shadow-pane"></div>
                        <div class="leaflet-pane leaflet-overlay-pane"></div>
                        <div class="leaflet-pane leaflet-marker-pane"></div>
                        <div class="leaflet-pane leaflet-tooltip-pane"></div>
                        <div class="leaflet-pane leaflet-popup-pane"></div>
                        <div class="leaflet-proxy leaflet-zoom-animated"
                            style="transform: translate3d(1.04805e+06px, 697379px, 0px) scale(4096);"></div>
                    </div>
                    <div class="leaflet-control-container">
                        <div class="leaflet-top leaflet-left">
                            <div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in"
                                    href="#" title="Zoom in" role="button" aria-label="Zoom in">+</a><a
                                    class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button"
                                    aria-label="Zoom out">−</a></div>
                        </div>
                        <div class="leaflet-top leaflet-right"></div>
                        <div class="leaflet-bottom leaflet-left"></div>
                        <div class="leaflet-bottom leaflet-right">
                            <div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com"
                                    title="A JS library for interactive maps">Leaflet</a> | Map data © <a
                                    href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a
                                    href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a
                                    href="https://www.mapbox.com/">Mapbox</a></div>
                        </div>
                    </div>
                </div>
                <form method="post" class="d-flex justify-content-center flex-column align-items-center mt-4 card w-75 py-5 shadow-sm">
                    {% csrf_token %}

                    <div class="d-flex justify-content-start w-75 align-items-center flex-column my-1">
{#                         <label for="lat-lng" class="w-100 mb-1">lat and lng:</label>#}
                        <textarea name="lat-lng" id="lat-lng" class="w-100 form-control" rows="6" hidden></textarea><!-- type = "hidden" -->
                    </div>
                    <div class="d-flex justify-content-start w-75 align-items-center flex-column my-1 ">
    {#                    <label for="startCount" class="w-100 mb-1">start counts:</label>#}
                        <input type="text" name="pointsCount" id="pointCount" class="w-100" hidden/>
                    </div>

                    <div class="d-flex align-items-center justify-content-center w-100">
                        <input type="submit" value="Set" class="d-flex mx-1 btn btn-primary justify-content-center" style="width: 15%"/>
                        <div class="d-flex mx-1" style="width: 15%">
                            <label for="files" class="btn btn-primary">Browse...</label>
                            <input id="files" style="visibility:hidden;" type="file">
                        </div>
                    </div>

                </form>
            </div>
            <div class="d-flex align-items-center flex-column justify-content-start align-items-start h-100 py-2" style="width: 40%">
                <p class="w-100 m-0 mb-1 px-2">List of locations:</p>
                <div class="d-flex align-items-start justify-content-start w-100 h-100">
                     <div class="d-flex border h-100 py-2 shadow-sm mx-2" style="width: 80%">
                     <ol id="lat-lng-list">
                    </ol>
                </div>
                </div>
            </div>
        </div>
    </div>

        <div class="d-flex flex-column flex-shrink-0 p-3 text-white bg-dark" style="width: 280px;">
            <a href="" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
              <span class="fs-4">Pages</span>
            </a>
            <hr>
            <ul class="nav nav-pills flex-column mb-auto">
              <li class="nav-item">
                <a href="/maps/startPoints" class="nav-link text-white" aria-current="page" id="startPoints-nav-item">
                  Start points
                </a>
              </li>
              <li>
                <a href="/maps/endPoints" class="nav-link text-white" id="endPoints-nav-item">
                  End points
                </a>
              </li>
              <li>
                <a href="/maps/emergencyPoints" class="nav-link text-white" id="emergencyPoints-nav-item">
                  Emergency locations
                </a>
              </li>
              <li>
                <a href="/maps/dangerousPoints" class="nav-link text-white" id="dangerousPoints-nav-item">
                  Dangerous locations
                </a>
              </li>
{#              <li>#}
{#                <a href="/maps/traffic" class="nav-link text-white" id="traffic-nav-item">#}
{#                  Traffic#}
{#                </a>#}
{#              </li>#}
            </ul>
        </div>
    </div>
    <div id="mapid" style="width: 600px; height: 400px; position: relative;"
        class="leaflet-container leaflet-retina leaflet-fade-anim leaflet-grab leaflet-touch-drag" tabindex="0">
        <div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);">
            <div class="leaflet-pane leaflet-tile-pane">
                <div class="leaflet-layer " style="z-index: 1; opacity: 1;">
                    <div class="leaflet-tile-container leaflet-zoom-animated"
                        style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt=""
                            role="presentation"
                            src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2046/1361?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                            class="leaflet-tile leaflet-tile-loaded"
                            style="width: 512px; height: 512px; transform: translate3d(-200px, -347px, 0px); opacity: 1;"><img
                            alt="" role="presentation"
                            src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2047/1361?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                            class="leaflet-tile leaflet-tile-loaded"
                            style="width: 512px; height: 512px; transform: translate3d(312px, -347px, 0px); opacity: 1;"><img
                            alt="" role="presentation"
                            src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2046/1362?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                            class="leaflet-tile leaflet-tile-loaded"
                            style="width: 512px; height: 512px; transform: translate3d(-200px, 165px, 0px); opacity: 1;"><img
                            alt="" role="presentation"
                            src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/12/2047/1362?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"
                            class="leaflet-tile leaflet-tile-loaded"
                            style="width: 512px; height: 512px; transform: translate3d(312px, 165px, 0px); opacity: 1;">
                    </div>
                </div>
            </div>
            <div class="leaflet-pane leaflet-shadow-pane"></div>
            <div class="leaflet-pane leaflet-overlay-pane"></div>
            <div class="leaflet-pane leaflet-marker-pane"></div>
            <div class="leaflet-pane leaflet-tooltip-pane"></div>
            <div class="leaflet-pane leaflet-popup-pane"></div>
            <div class="leaflet-proxy leaflet-zoom-animated"
                style="transform: translate3d(1.04805e+06px, 697379px, 0px) scale(4096);"></div>
        </div>
        <div class="leaflet-control-container">
            <div class="leaflet-top leaflet-left">
                <div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in"
                        href="#" title="Zoom in" role="button" aria-label="Zoom in">+</a><a
                        class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button"
                        aria-label="Zoom out">−</a></div>
            </div>
            <div class="leaflet-top leaflet-right"></div>
            <div class="leaflet-bottom leaflet-left"></div>
            <div class="leaflet-bottom leaflet-right">
                <div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com"
                        title="A JS library for interactive maps">Leaflet</a> | Map data © <a
                        href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a
                        href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a
                        href="https://www.mapbox.com/">Mapbox</a></div>
            </div>
        </div>
    </div>
    <script>

        let loc = {{ myloc| safe}};
        var mymap = L.map('mapid').setView(loc, 13);
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
                '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1
        }).addTo(mymap);

        var locations = [];
        var Counter = 0;
        var popupContent = ' \
            <form id="popupForm" method="get" >\
                <input id="pCount" type="number"/>\
                <input type="submit" value="Set" />\
            </form>\
             ';

        var pCount = 0;
        mymap.on('click', function(e){
            Counter++;
  		    var coord = e.latlng;
  		    var lat = coord.lat;
  		    var lng = coord.lng;
            locations.push([lat,lng]);
            document.getElementById('lat-lng').value = locations.toString();
            document.getElementById('pointCount').value = Counter.toString();
            L.marker(coord).addTo(mymap);//.bindPopup(popupContent).openPopup()
            pCount = L.DomUtil.get('pCount');
            console.log(pCount);
  		    console.log(Counter + "You clicked the map at latitude: " + lat + " and longitude: " + lng);
            document.getElementById('lat-lng-list').innerHTML += `<li class="mt-1">${lat} - ${lng}</li>`

            console.log(locations);
  	    });
         const path = '{{ request.path }}'
        document.getElementById(`${path.split('/')[2].split('#')[0]}-nav-item`).classList.add('active')



    </script>

</body>

</html>